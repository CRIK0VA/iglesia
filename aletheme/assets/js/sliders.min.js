jQuery(document).ready(function(e){function t(e,t,n){return aletheme_sliders_js.timurl+"?src="+e+"&w="+t+"&h="+n+"&q=100"}e.fn.aletheme_edit_slider=function(){function t(t){return e('<div class="slide" id="aletheme-slide-'+t+' " data-id="0">'+'<div class="handle" title="Click and drag to reorder">SORT</div>'+'<a href="#" class="delete">Delete</a>'+'<div class="box-image"><div class="image"><img /></div><span><input type="text" name="image" placeholder="Or enter an image URL" /></span></div>'+'<div class="box-content">'+'<div class="box-title"><span>Title</span><input type="text" value="" name="title" /></div>'+'<div class="box-url"><span>URL</span><input type="text" value="" name="url" /></div>'+'<div class="box-description"><span>Description</span><textarea cols="30" rows="4" name="description" class="description"></textarea></div>'+'<div class="box-html"><span>HTML</span><textarea cols="30" rows="4" name="html" class="html"></textarea></div>'+"</div></div>")}function n(){alert("Something went wrong. Please reload the page and try again.")}function r(t){var n=[];t.each(function(){var t=e(this);n.push({id:t.data("id"),image:t.find("input[name=image]").val(),title:t.find("input[name=title]").val(),url:t.find("input[name=url]").val(),description:t.find("textarea[name=description]").val(),html:t.find("textarea[name=html]").val()})});return n}function i(t){t.find(".image").click(function(n){var r=t.find('input[name="image"]');tb_show("","media-upload.php?type=image&amp;TB_iframe=true");e("#TB_window,#TB_overlay,#TB_HideSelect").one("unload",function(e){e.stopPropagation();e.stopImmediatePropagation();return!1});window.send_to_editor=function(t){tb_remove();t=e(t);var n="";t.is("img")?n=t.prop("src"):n=jQuery("img",t).prop("src");r.val(n).triggerHandler("change")}});t.find("input[name='image']").bind("change",function(n,r){var i=e(this),s=300,o=200,u=i.val();if(u){var a=u;e("<img />").load(function(){var e=t.find(".image img");e.attr("src",this.src)}).error(function(){i.addClass("err");t.find(".image img").attr("src",aletheme_sliders_js.assetsurl+"/images/blank.gif")}).attr("src",a)}else t.find(".image img").attr("src",aletheme_sliders_js.assetsurl+"/images/blank.gif")}).triggerHandler("change",!0);t.find("a.delete").click(function(t){t.preventDefault();if(!confirm("Delete this entry?"))return;var r=e(this),i=r.parent(),s=i.data("id");if(!s){i.fadeOut(function(){e(this).remove()});return}e.post(aletheme_sliders_js.ajaxurl,{action:"delete_slide",id:s},function(t){t.state=="success"?i.fadeOut(function(){e(this).remove()}):n()},"json")})}e(this).each(function(){var n=e(this),s=e("#aletheme-slides-sortable");s.sortable({placeholder:"sortable-placeholder",items:".slide",handle:".handle",cursor:"move",distance:2,tolerance:"pointer",helper:"clone",forcePlaceholderSize:!0,opacity:.7,change:function(){}});s.find(".slide").each(function(){i(e(this))});e("#aletheme-add-new-slide-button").click(function(e){e.preventDefault();var n=t(s.find(".slide").length);s.append(n);i(n)});e("#aletheme-save-slider-button").click(function(t){t.preventDefault();var i=e(this),o=s.find(".slide"),u=r(o),a=n.data("id"),f=e("#aletheme-sliders-loading");i.addClass("button-primary-disabled");f.css("visibility","visible");e.post(aletheme_sliders_js.ajaxurl,{action:"save_slider",id:a,title:e("#titlewrap input").val(),entries:u},function(t){i.removeClass("button-primary-disabled");f.css("visibility","hidden");n.data("id",t.id);o.each(function(n){e(this).data("id",t.slides[n])})},"json")});e("#aletheme-create-slider").click(function(t){e(this).parents("form").submit()});e("#aletheme-slider-delete").click(function(e){return confirm("Are you sure you want to remove this slider?")?!0:!1});var o=e("#aletheme-slider-info .shortcode");if(o.length){var u=e("#aletheme-slider-shortcode"),a=function(){u.val(aletheme_generate_slider_shortcode(o.data("slug"),o.find("select")))};o.find("select").change(a);u.click(function(){e(this).select()});a()}var f=e("#aletheme-slider-info-hide");if(f.length){var l;typeof localStorage!="undefined"&&(l=localStorage.getItem("ale-slider-hide-area-visibile"));if(l==null){l=1;typeof localStorage!="undefined"&&localStorage.setItem("ale-slider-hide-area-visibile",l)}l=parseInt(l);var c=e('<a href="#">'+(l?"Hide":"Show")+" Shortcode Generator</a>");l||e("#aletheme-slider-info").hide();f.prepend(c);c.click(function(t){t.preventDefault();e("#aletheme-slider-info").slideToggle("fast",function(){var t=e(this);c.text(t.is(":visible")?"Hide Shortcode Generator":"Show Shortcode Generator");typeof localStorage!="undefined"&&localStorage.setItem("ale-slider-hide-area-visibile",t.is(":visible")?1:0)})})}})};e("#aletheme-edit-slider-page").aletheme_edit_slider();e.fn.aletheme_manage_sliders=function(){e(this).each(function(){})}});